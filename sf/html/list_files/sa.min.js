/*!
 * SFbest.com Statistical Analysis JavaScript Library
 * 
 * Author mengfankang@sf-express.com
 * Date  2014.09.23
 */
!function(){var a="_sf_tj_cc",b="_sf_source_id",c="_sf_csource_id",d=2592e3,e="sfsource",f="sfsource_c",g="DA_UID",h=15552e3,i=1800,j="http://stream."+window.location.host.split(".")[1]+".com/click-stream/sa.gif",k=["baidu","google","sogou","so","soso","bing","yahoo","youdao"],l=["wd","","query","q","query","q","","q"],m=function(){var a=new Date;return{toTomorrowSecond:function(){var b=a;return 86400-3600*b.getHours()-60*b.getMinutes()-b.getSeconds()},dc:function(a){return"function"==typeof window.decodeURIComponent?window.decodeURIComponent(a):a},ec:function(a){return"function"==typeof window.encodeURIComponent?window.encodeURIComponent(a):a},cookieEnable:function(){return window.navigator.cookieEnabled?1:0},getCookie:function(a){var b=null;if(window.document.cookie&&""!=window.document.cookie)for(var c=window.document.cookie.split(";"),d=0;d<c.length;d++){var e=c[d].toString().replace(/(^\s*)|(\s*$)/g,"");if(e.substring(0,a.length+1)==a+"="){b=this.dc(e.substring(a.length+1));break}}return b},setCookie:function(a,b,c,d){if(this.cookieEnable()){if(c&&("number"==typeof c||c.toUTCString)){var e;"number"==typeof c?(e=new Date,e.setTime(e.getTime()+1e3*c)):e=c,c="; expires="+e.toUTCString()}var f="; path=/",d="; domain="+(d?d:"");window.document.cookie=[a,"=",this.ec(b),c,f,d].join("")}},deleteCookie:function(a,b){this.setCookie(a,null,-1,b)},time:function(){return Math.round(a.getTime()/1e3)},image:function(a){(new Image).src=a},mergeArray:function(a,b){return a.constructor===Array&&b.constructor===Array?a.concat(b):[]},createUUID:function(){for(var b="abcdefghijklmnopqrstuvwxyz0123456789".split(""),c=0,d=b.length,e="";11>c;c++)e+=b[Math.floor(Math.random()*d)];return e+a.getTime()},map:function(a,b){if(a.constructor===Array&&b.constructor===Function){for(var c=0,d=a.length,e=[];d>c;c++)e[c]=b(a[c],c,a);return e}return[]},hostByUrl:function(a){if("string"!=typeof a)return"";var b=a.split("/"),c=b[2]||"";return c},inArray:function(a,b){for(var c=0,d=b.length;d>c;c++)if(a==b[c])return c;return-1},queryKey:function(a,b){var c=b.indexOf("?")>-1?b.split("?")[1]:b;if(!c)return"";for(var f,d=c.split("&"),e=m.map(d,function(b){var c=b.split("=");return c[0]&&c[1]&&c[0]==a?c[1]:null});;)if(f=e.pop(),null!=f||!e.length)break;return f?f:""}}}(),n=function(){var a=window._sa_sf||[],b=window||{},c=b.screen||{},d=b.document||{},f=(b.encodeURIComponent,b.navigator||{}),g=f.userAgent,h=b.location||{};return{protocol:function(){return"https:"==h.protocol?"https":"http"},currDomain:function(){return h.hostname?h.hostname:""},port:function(){return h.port?h.port:80},topDomain:function(){return this.currDomain().split(".").slice(-2).join(".")},userAgent:function(){return g?g:""},currUrl:function(){return h.href?h.href:""},referrer:function(){return d.referrer?d.referrer:""},language:function(){var a=f.systemLanguage||f.language||"";return a.toLowerCase()},screen:function(){return c.width&&c.height?c.width+"x"+c.height:"0x0"},color:function(){return c.colorDepth?c.colorDepth+"-bit":""},title:function(){return d.title?d.title:""},charset:function(){return d.characterSet?d.characterSet:d.charset?d.charset:""},flash:function(){var a="";if(f.plugins&&f.plugins.length){for(var b=0;b<f.plugins.length;b++)if(-1!=f.plugins[b].name.indexOf("Shockwave Flash")){a=f.plugins[b].description.split(" ")[2];break}}else for(var b=15;b>=2;b--)try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+b);if("object"==typeof c){a=b+".0";break}}catch(d){}return a},java:function(){return"undefined"!=typeof f.javaEnabled?f.javaEnabled()?1:0:""},query:function(){var a;return h.search?a=h.search.substring(1):(a=this.currUrl().split("?"),a=a.length>0&&a[1]?a[1]:""),a},hash:function(){return h.hash?h.hash:""},globalConfig:function(b){for(var c=0,d=a.length;d>c;c++){var e=a[c];if(e[0]&&e[1]&&e[0]==b)return e[1]}return""},isIndex:function(){var a=!1,b=this.currUrl().split("/")[3],c="www"+n.globalConfig("domain"),d=this.currUrl().split("/")[2],e=[/^$/,/^index\.php/,/^site/,/^\?/,/^\#/];if(b&&d==c)for(var f=0,g=e.length;g>f;f++)if(e[f].test(b)){a=!0;break}return a}}}(),o=function(b,c){var d=m.getCookie(a),e=d?d.split("."):[];e[b]=c,m.setCookie(a,e.join("."),h,n.globalConfig("domain"))},p=function(b){var c=m.getCookie(a),d=c?c.split("."):[];return d[b]?d[b]:""},q={set:function(a){return o(2,a),this},get:function(){return p(2)}},r={set:function(a){return o(1,a),this},get:function(){return p(1)}},s={set:function(a){return o(3,a),this},get:function(){return p(3)}},t={set:function(){var a=p(4);return a=a?Number(a)+1:1,o(4,a),this},get:function(){var a=p(4);return a?a:1},reset:function(a){return o(4,a),this}},u={set:function(){var a=p(5);return a=a?Number(a)+1:1,o(5,a),this},get:function(){var a=p(5);return a?a:1},reset:function(a){return o(5,a),this}},v={set:function(a){return o(6,a),this},get:function(){return p(6)}},w={set:function(a){return o(7,a),this},get:function(){return p(7)}},x=function(){return j+"?"},y={set:function(a){return o(0,a),this},get:function(){return p(0)}},z=function(){var a=G(e);a&&m.setCookie(b,a,d,n.globalConfig("domain"))},A=function(){var a=G(f);a&&m.setCookie(c,a,d,n.globalConfig("domain"))},B=function(){var a=m.getCookie(b);return a?a:""},C=function(){var a=m.getCookie(c);return a?a:""},D=function(a){var b=[[/(trackref=)*sfbest_Uhead_Uhead_menu_category(\d+)-(hot|banner|channel|activity|brand)?(\d*)/,"$1sfbest_hp_hp_menu_category$2-$3$4"]],c=a.attr("name"),d=a.attr("href");if(n.isIndex()){for(var e=0,f=b.length;f>e;e++)d=d.replace(b[e][0],b[e][1]),c=c.replace(b[e][0],b[e][1]);a.attr("href",d).attr("name",c)}},E=function(){var a=n.referrer(),b=n.globalConfig("domain"),c=v.get(),d=m.time(),e=!1,f=w.get(),g=y.get();if(a){var h=a.split("/"),j=h[2]?h[2].split("."):[],k=j.join("*"),l="";l=(j.length>0?"."+j.pop():"")+l,l=(j.length>0?"."+j.pop():"")+l,"."!=b.substring(0,1)&&(b="."+b),b!=l&&(e=!0,w.set(k))}e&&k!=f&&(a=!1),d-c>i&&(a=!1),g?a===!1?(q.set(s.get()),s.set(m.time()),t.set(),u.reset(1)):u.set():(y.set(m.createUUID()),r.set(m.time()),s.set(m.time()),u.reset(1),t.reset(1)),z(),A()},F=function(){var a=n.currUrl().match(/\/(\d+)\.html/i);return a&&a[1]?a[1]:""},G=function(a){return m.dc(m.queryKey(a,n.query()))},H=function(){if("undefined"==typeof $)return"";var b,c,a=n.currUrl();return-1!=a.toLowerCase().indexOf("/productlist/search")&&(b=$(".total").html())&&(c=b.match(/(\d+)/),c[1])?c[1]:""},I=function(){var a=m.getCookie(g);return a?a:0},J=function(){var b,c,a=n.hash();return b=(c=a.match(/\#trackref=(.+)/i))&&c[1]?c[1]:G("trackref")},K=function(){if("undefined"==typeof $)return"";var a=$("#main table tr:eq(1) td:eq(0)").html(),b=a?a.replace(/[^\d]+/gi,""):"";return Number(b)==b&&16==b.length?b:""},L=function(){var a=n.referrer(),b=m.hostByUrl(a),c="",d=-1;if(b){for(var e=b.split("."),f=0,g=k.length;g>f;f++)if(m.inArray(k[f],e)>-1){d=f,c+=k[f];break}if(c){var h=m.queryKey(l[d],n.referrer());c+=h?"|"+m.dc(h):""}}return c},M=function(){var a=[];a.push(["cs",n.charset()]),a.push(["sr",n.screen()]),a.push(["sc",n.color()]),a.push(["la",n.language()]),a.push(["fl",n.flash()]),a.push(["dt",n.title()]),a.push(["hn",n.currDomain()]),a.push(["rf",n.referrer()]),a.push(["ul",n.currUrl()]),a.push(["ua",n.userAgent()]),a.push(["pc",n.protocol()]),a.push(["je",n.java()]),a.push(["pt",n.port()]),a.push(["tm",m.time()]),a.push(["uu",y.get()]),a.push(["lt",q.get()]),a.push(["lm",v.get()]),a.push(["ft",r.get()]),a.push(["ct",s.get()]),a.push(["tn",t.get()]),a.push(["pn",F()]),a.push(["sk",G("keyword")]),a.push(["id",I()]),a.push(["re",J()]),a.push(["od",K()]),a.push(["vf",w.get().split("*").join(".")]),a.push(["sf",B()]),a.push(["sfc",C()]);var b=u.get(),c=2>b?L():"";a.push(["sd",c]),a.push(["cn",b]);var d=H(),e=G("pageNo");return d&&!e&&(e=1),a.push(["sp",d]),a.push(["sn",e]),a},N=function(a){for(var e,b=[],c=0,d=a.length;d>c;c++)e=a[c],"undefined"!=typeof e[1]&&b.push(m.ec(e[0])+"="+m.ec(e[1]));return b.join("&")},O=function(){E()},P=function(){v.set(m.time())},Q=function(a,b){var c=M();return c.push(["nm",b]),c.push(["pd",a]),c},R=function(a,b){var c=Q(a,b),d=N(c),e=x(),f=e+d;m.image(f)},S=function(){return"undefined"==typeof $?!1:($("a.trackref").live("click",function(){var d,a=$(this),b=$(this).attr("href"),c=$(this).attr("name");hasref=!1,(d=b.match(/\#trackref=(.+)/i))&&d[1]&&(hasref=!0),m.queryKey("trackref",b)&&(hasref=!0),c&&0==hasref&&a.attr("href",b+"#trackref="+c),D(a)}),void 0)},T=function(){O();var a=M(),b=N(a),c=x(),d=c+b;m.image(d),P()};T(),S(),window.sendAddCartToWebLog=R}();